(this["webpackJsonpreact-blog"]=this["webpackJsonpreact-blog"]||[]).push([[0],{30:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r,c,a,s,i,o,u,j,b,l,d,p,h,O,f,x,m,g=n(22),v=n.n(g),w=(n(30),n(10)),k=n(2),y=n(0),S=n(3),C=n(11),E=n(4),I=Object(y.createContext)(null),$="token",z=function(e){return localStorage.setItem($,e)},A=function(){return localStorage.getItem($)},D=n(1),J=S.a.header(r||(r=Object(k.a)(["\n  background: white;\n  height: 4rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0 2rem;\n"]))),U=S.a.div(c||(c=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  gap: 4rem;\n"]))),B=S.a.h1(a||(a=Object(k.a)([""]))),L=S.a.div(s||(s=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  height: 4rem;\n"]))),N=Object(S.a)(C.b)(i||(i=Object(k.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  width: 6rem;\n  cursor: pointer;\n\n  background: ","\n"])),(function(e){return e.$active?"rgba(0, 0, 0, 0.3)":""})),P=function(){var e=Object(y.useContext)(I),t=e.user,n=e.setUser,r=Object(E.g)(),c=Object(E.f)();return Object(D.jsxs)(J,{children:[Object(D.jsxs)(U,{children:[Object(D.jsx)(B,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(D.jsxs)(L,{children:[Object(D.jsx)(N,{to:"/",$active:"/"===r.pathname,children:"\u9996\u9801"}),t&&Object(D.jsx)(N,{to:"/new",$active:"/new"===r.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(D.jsx)(L,{children:t?Object(D.jsx)(N,{to:"/",onClick:function(){z(null),n(null),"/"!==r.pathname&&c.push("/")},children:"\u767b\u51fa"}):Object(D.jsx)(N,{to:"/login",$active:"/login"===r.pathname,children:"\u767b\u5165"})})]})},_=n(6),F=n.n(_),M=n(12),T="https://student-json-api.lidemy.me",q=function(){var e=Object(M.a)(F.a.mark((function e(){var t,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(T,"/posts?_sort=createdAt&_order=desc"));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(T,"/posts/").concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(T,"/users/").concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(M.a)(F.a.mark((function e(t,n){var r,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(T,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:n})});case 2:return r=e.sent,e.next=5,r.json();case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Q=function(){var e=Object(M.a)(F.a.mark((function e(){var t,n,r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A(),e.prev=1,e.next=4,fetch("".concat(T,"/me"),{headers:{authorization:"Bearer ".concat(t)}});case 4:if((n=e.sent).ok){e.next=7;break}throw new Error("Network response was not ok in getMe.");case 7:return e.next=9,n.json();case 9:return r=e.sent,e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",{ok:0,data:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),R=S.a.div(o||(o=Object(k.a)(["\n  width: 50rem;\n  margin: 0 auto;\n"]))),V=S.a.article(u||(u=Object(k.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 1rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-end;\n"]))),W=Object(S.a)(C.b)(j||(j=Object(k.a)(["\n  font-size: 1.5rem;\n  color: #333;\n"]))),X=S.a.p(b||(b=Object(k.a)(["\n  flex-shrink: 0;\n  color: rgba(0, 0, 0, 0.8);\n"]))),Y=function(e){var t=e.post,n=t.title,r=t.createdAt;return Object(D.jsxs)(V,{children:[Object(D.jsx)(W,{to:"/posts/".concat(t.id),children:n}),Object(D.jsx)(X,{children:new Date(r).toLocaleString()})]})},Z=function(){var e=Object(y.useState)([]),t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(y.useEffect)((function(){q().then((function(e){r(e)}))}),[]),Object(D.jsx)(R,{children:n.map((function(e){return Object(D.jsx)(Y,{post:e},e.id)}))})},ee=S.a.h2(l||(l=Object(k.a)(["\n  color: red;\n"]))),te=function(){var e=Object(y.useContext)(I).setUser,t=Object(y.useState)(""),n=Object(w.a)(t,2),r=n[0],c=n[1],a=Object(y.useState)(""),s=Object(w.a)(a,2),i=s[0],o=s[1],u=Object(y.useState)(""),j=Object(w.a)(u,2),b=j[0],l=j[1],d=Object(E.f)(),p=function(){var t=Object(M.a)(F.a.mark((function t(n){var c,a,s,o,u;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),l(null),t.next=4,K(r,i);case 4:if(c=t.sent,a=c.message,s=c.token,c.ok){t.next=9;break}return l(a),t.abrupt("return");case 9:return z(s),t.next=12,Q();case 12:if(o=t.sent,u=o.data,o.ok){t.next=18;break}return z(null),l(u),t.abrupt("return");case 18:e(u),d.push("/");case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(D.jsxs)("form",{onSubmit:p,children:[Object(D.jsxs)("label",{children:["username:",Object(D.jsx)("input",{value:r,onChange:function(e){return c(e.target.value)}})]}),Object(D.jsxs)("label",{children:["password:",Object(D.jsx)("input",{type:"password",value:i,onChange:function(e){return o(e.target.value)}})]}),Object(D.jsx)("button",{children:"\u767b\u5165"}),b&&Object(D.jsx)(ee,{children:b})]})},ne=S.a.div(d||(d=Object(k.a)(["\n  width: 42.5rem;\n  margin: 0 auto;\n"]))),re=S.a.h2(p||(p=Object(k.a)(["\n  border-bottom: 1px solid #333;\n  margin: 0;\n  padding: 1rem 0;\n  font-size: 3rem;\n  font-weight: 400;\n  line-height: 3.75rem;\n  color: #292929;\n"]))),ce=S.a.div(h||(h=Object(k.a)(["\n  display: flex;\n  flex-direction: column;\n  padding: 1rem 0 ;\n"]))),ae=S.a.span(O||(O=Object(k.a)([""]))),se=S.a.span(f||(f=Object(k.a)([""]))),ie=S.a.main(x||(x=Object(k.a)([""]))),oe=function(){var e=Object(E.h)().id,t=Object(y.useState)(null),n=Object(w.a)(t,2),r=n[0],c=n[1],a=Object(y.useState)(null),s=Object(w.a)(a,2),i=s[0],o=s[1];return Object(y.useEffect)((function(){G(e).then((function(e){c(e)}))}),[e]),Object(y.useEffect)((function(){r&&H(r.userId).then((function(e){o(e)}))}),[r]),Object(D.jsx)(D.Fragment,{children:r&&i&&Object(D.jsxs)(ne,{children:[Object(D.jsxs)("div",{children:[Object(D.jsx)(re,{children:r.title}),Object(D.jsxs)(ce,{children:[Object(D.jsx)(ae,{children:i&&i.nickname}),Object(D.jsx)(se,{children:new Date(r.createdAt).toLocaleString()})]})]}),Object(D.jsx)(ie,{children:r.body})]})})},ue=S.a.div(m||(m=Object(k.a)(["\n padding-top: 4rem;\n"])));var je=function(){var e=Object(y.useState)(null),t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(y.useEffect)((function(){A()&&Q().then((function(e){var t=e.ok,n=e.data;t?r(n):console.log(n)}))}),[]),Object(D.jsx)(I.Provider,{value:{user:n,setUser:r},children:Object(D.jsx)(ue,{children:Object(D.jsxs)(C.a,{children:[Object(D.jsx)(P,{}),Object(D.jsxs)(E.c,{children:[Object(D.jsx)(E.a,{exact:!0,path:"/",children:Object(D.jsx)(Z,{})}),Object(D.jsx)(E.a,{path:"/login",children:Object(D.jsx)(te,{})}),Object(D.jsx)(E.a,{path:"/posts/:id",children:Object(D.jsx)(oe,{})})]})]})})})};v.a.render(Object(D.jsx)(je,{}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.350eb526.chunk.js.map